<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Simulate multiple instances · FMI.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.png" alt="FMI.jl logo"/></a><form class="docs-search" action="../../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../../">Introduction</a></li><li><input class="collapse-toggle" id="menuitem-2" type="checkbox"/><label class="tocitem" for="menuitem-2"><span class="docs-label">Tutorials</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../tutorials/overview/">Overview</a></li><li><a class="tocitem" href="../../tutorials/load_unload/">Load/Unload a FMU</a></li><li><a class="tocitem" href="../../tutorials/simulate/">Simulate a FMU</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-3" type="checkbox" checked/><label class="tocitem" for="menuitem-3"><span class="docs-label">Examples</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../examples/">Overview</a></li><li><a class="tocitem" href="../CS_simulation/">Simulation of a CS FMU</a></li><li><a class="tocitem" href="../simulateME/">Simulation of a ME FMU</a></li><li><a class="tocitem" href="../parameterize/">Parameterize</a></li><li class="is-active"><a class="tocitem" href>Simulate multiple instances</a></li></ul></li><li><input class="collapse-toggle" id="menuitem-4" type="checkbox"/><label class="tocitem" for="menuitem-4"><span class="docs-label">Library Functions</span><i class="docs-chevron"></i></label><ul class="collapsed"><li><a class="tocitem" href="../../library/library/">FMI 2 library functions</a></li><li><a class="tocitem" href="../../library/library_ind/">FMI version independent functions</a></li><li><a class="tocitem" href="../../library/fmu2/">FMU 2 functions</a></li><li><a class="tocitem" href="../../library/fmu/">FMU version independent functions</a></li></ul></li><li><a class="tocitem" href="../../related/">Related Publications</a></li><li><a class="tocitem" href="../../contents/">Contents</a></li><li><a class="tocitem" href="../../indices/">Library Index</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Examples</a></li><li class="is-active"><a href>Simulate multiple instances</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Simulate multiple instances</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/ThummeTo/FMI.jl/blob/master/docs/src/examples/multipleInstance.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Simulate-multiple-instances"><a class="docs-heading-anchor" href="#Simulate-multiple-instances">Simulate multiple instances</a><a id="Simulate-multiple-instances-1"></a><a class="docs-heading-anchor-permalink" href="#Simulate-multiple-instances" title="Permalink"></a></h1><p>This example shows how to work with multiple instances of a FMU.</p><p>This first command loads the FMI.jl library, so you could work with it.</p><pre><code class="language-julia">#
# Copyright (c) 2021 Tobias Thummerer, Lars Mikelsons, Josef Kircher
# Licensed under the MIT license. See LICENSE file in the project root for details.
#

using FMI</code></pre><p>The path to the FMU which we want to create multiple instances of is set. <a href="../../library/fmu/#FMI.fmiLoad"><code>fmiLoad</code></a> unpacks the FMU, reads the model description and stores all the necessary information of the FMU in <code>myFMU</code>. With <a href="../../library/library_ind/#FMI.fmiInstantiate!"><code>fmiInstantiate!</code></a> a first instance of the FMU is created.</p><pre><code class="language-julia">pathToFMU = joinpath(dirname(@__FILE__), &quot;../model/Dymola/2020x/SpringPendulum1D.fmu&quot;)

myFMU = fmiLoad(pathToFMU)

#create an instance and simulate it
comp1 = fmiInstantiate!(myFMU; loggingOn=true)</code></pre><p>To simulate the instance of the FMU you have to setup the experiment and enter and leave the initialization mode to prepare the FMU. This part is optional if you use the option <code>setup=true</code> in <a href="../../library/fmu/#FMI.fmiSimulateCS"><code>fmiSimulateCS</code></a>.</p><pre><code class="language-julia">fmiSetupExperiment(comp1, 0.0)
fmiEnterInitializationMode(comp1)
fmiExitInitializationMode(comp1)</code></pre><p>The next part sets up the start and stop time.</p><pre><code class="language-julia">t_start = 0.0
t_stop = 8.0</code></pre><p>The next part is the actual simulation. You can provide an array of variable names which you want to track. The return value of the function is that data.</p><pre><code class="language-julia">data1 = fmiSimulateCS(comp1, t_start, t_stop; recordValues=[&quot;mass.s&quot;])</code></pre><p>The result of the simulation can be visualized using the <a href="../../library/fmu/#FMI.fmiPlot"><code>fmiPlot</code></a> function.</p><pre><code class="language-julia">fmiPlot(data1)</code></pre><p>In the second part of the example we create a second instance of the FMU and change the spring stiffness. Then we simulate and plot it. If you compare the two plots you can see the different simulation results due to the adjusted spring stiffness.</p><pre><code class="language-julia">#create another instance, change the spring stiffness and simulate it
comp2 = fmiInstantiate!(myFMU; loggingOn=true)
fmiSetupExperiment(comp2, 0.0)
fmiEnterInitializationMode(comp2)
springConstant = fmiGetReal(comp2, &quot;spring.c&quot;) * 0.1
fmiSetReal(comp2, &quot;spring.c&quot;, springConstant)
fmiExitInitializationMode(comp2)
data2 = fmiSimulateCS(comp2, t_start, t_stop; recordValues=[&quot;mass.s&quot;])
fmiPlot(data2)



fmiUnload(myFMU)</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../parameterize/">« Parameterize</a><a class="docs-footer-nextpage" href="../../library/library/">FMI 2 library functions »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 6 October 2021 15:35">Wednesday 6 October 2021</span>. Using Julia version 1.5.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
